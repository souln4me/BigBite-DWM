<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Big Bite - Hamburguesas Gourmet</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Bootstrap Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

  <!-- Icono -->
  <link rel="icon" type="image/png" sizes="32x32" href="img/logo/cropped_circle_image.png">


  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">
  <!-- CSS -->
  <link rel="stylesheet" href="css/navbar.css">
  <link rel="stylesheet" href="css/productos.css">
  <link rel="stylesheet" href="css/inicio.css">
</head>


<body class="d-flex flex-column min-vh-100">
  <div id="navbar-placeholder"></div>

  <main class="flex-grow-1">
    <div id="demo" class="carousel slide" data-bs-ride="carousel">

      <div class="carousel-indicators">
        <button type="button" data-bs-target="#demo" data-bs-slide-to="0" class="active"></button>
        <button type="button" data-bs-target="#demo" data-bs-slide-to="1"></button>
      </div>

      <div class="carousel-inner">
        <div class="carousel-item active">
          <img src="img/banners/BannerBigBite_upd.png" alt="Promo Cupón" class="d-block" class="d-block w-100">
        </div>
        <div class="carousel-item">
          <img src="img/banners/Banner02.png" alt="Promo Combo Clásico" class="d-block" class="d-block w-100">
        </div>
      </div>

      <button class="carousel-control-prev" type="button" data-bs-target="#demo" data-bs-slide="prev">
        <span class="carousel-control-prev-icon"></span>
      </button>
      <button class="carousel-control-next" type="button" data-bs-target="#demo" data-bs-slide="next">
        <span class="carousel-control-next-icon"></span>
      </button>
    </div>

    <section id="inicio-promociones" class="container my-5">
      <h2 class="mb-5 text-center">Promociones</h2>
      <div class="row justify-content-center g-4">
      </div>

      <!-- Llamado a la acción -->
      <div class="cta mt-5 reveal">
        <h2>¡Revisa nuestro menú!</h2>
        <p>Descubre todas nuestras hamburguesas gourmet, papas fritas y combos irresistibles.
          ¡Tenemos algo perfecto para cada antojo!</p>
        <a href="productos.html" class="btn btn-lg">
          <i class="bi bi-bag-check-fill me-2"></i> Ver catálogo
        </a>
      </div>
    </section>

    <!-- Local -->
    <section id="inicio-local" class="container my-5 reveal">
      <div class="row align-items-center">
        <div class="col-lg-6">
          <img src="img/local/local-big-bite-gourmet-y-combos-por-fuera-vista-del-l.jpg" alt="Local Big Bite">
        </div>
        <div class="col-lg-6">
          <h2>¡Conoce nuestro local!</h2>
          <p class="lead">
            Ven a vivir la experiencia Big Bite: un ambiente acogedor, moderno y con el mejor sabor gourmet.
            ¡Estamos listos para recibirte con nuestras hamburguesas más jugosas y tus papas favoritas!
          </p>
          <a href="contacto.html" class="btn btn-warning fw-bold px-4 py-2">
            <i class="bi bi-geo-alt-fill me-2"></i> Ver ubicación
          </a>
        </div>
      </div>
    </section>

    <div class="mt-4 mb-4"></div>
  </main>

  <div id="footer-placeholder"></div>

  <script src="JS/config.js"></script>
  <script src="JS/navbar-loader.js"></script>

  <script>
    // ====================================
    // LÓGICA DE PRODUCTOS DESTACADOS
    // ====================================

    async function cargarDestacados() {
      const query = `
          query {
            getProductos {
              id
              nombre
              precio
              img
              es_destacado
              categoria { nombre }
            }
          }
        `;

      try {
        const res = await fetch(GRAPHQL_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ query })
        });
        const json = await res.json();
        const productos = json.data.getProductos || [];

        const destacados = productos.filter(p => p.es_destacado === true);

        renderizarPromociones(destacados);
      } catch (e) {
        console.error("Error cargando destacados:", e);
      }
    }

    function renderizarPromociones(lista) {
      const contenedor = document.querySelector('#inicio-promociones .row');

      // Si no hay destacados, mostramos un mensaje o dejamos lo que estaba
      if (lista.length === 0) {
        contenedor.innerHTML = '<p class="text-center text-muted">Pronto tendremos nuevas promociones.</p>';
        return;
      }

      // Limpiamos el HTML "quemado"
      contenedor.innerHTML = '';

      lista.forEach(p => {
        const precioFmt = '$' + p.precio.toLocaleString('es-CL');

        const imgUrl = p.img || 'img/logo/cropped_circle_image.png';

        const linkDestino = 'productos.html';

        const cardHtml = `
                <div class="col-sm-3 d-flex align-items-stretch reveal">
                  <a href="${linkDestino}" class="text-decoration-none text-dark w-100">
                    <div class="card text-center product-card w-100">
                      <img src="${imgUrl}" class="card-img-top" alt="${p.nombre}" style="height: 280px; object-fit: cover;">
                      <div class="card-body p-3 d-flex flex-column justify-content-between">
                        <div>
                            <small class="card-subtitle text-muted">${p.categoria ? p.categoria.nombre.toUpperCase() : ''}</small>
                            <h6 class="card-title mb-1">${p.nombre}</h6>  
                        </div>
                        <p class="card-text mb-0 mt-2 fw-bold text-success">${precioFmt}</p>
                      </div>
                    </div>
                  </a>  
                </div>
            `;
        contenedor.innerHTML += cardHtml;
      });
      activarAnimaciones();
    }

    // Ejecutar al cargar
    document.addEventListener('DOMContentLoaded', cargarDestacados);

    // ==========================================
    // EFECTO SCROLL REVEAL (INTERSECTION OBSERVER)
    // ==========================================

    const observerOptions = {
      root: null, // El viewport
      threshold: 0.15, // Se activa cuando el 15% del elemento es visible
      rootMargin: "0px"
    };

    const observer = new IntersectionObserver((entries, observer) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('active');
          observer.unobserve(entry.target); // Deja de observar una vez animado
        }
      });
    }, observerOptions);

    // Función para activar el observador en elementos nuevos
    function activarAnimaciones() {
      const elementos = document.querySelectorAll('.reveal');
      elementos.forEach(el => observer.observe(el));
    }

    // Ejecutar al inicio para elementos estáticos
    document.addEventListener('DOMContentLoaded', () => {
      activarAnimaciones();
    });



  </script>
</body>

</html>